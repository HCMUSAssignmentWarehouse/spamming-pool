<!DOCTYPE html>
<html>
	<head>
		<title>External Transfer</title>
		<meta charset="utf-8">
	</head>
	<body style="background-color: #BBDEFB">

		<div style="width: 100%; text-align: center;">
			<button id="user_infor" onclick="dashboard()" style="width: 15%; height: 50px; background-color: #1A5276; font-size: 20px; color: rgb(255,255,255); border-style: none;">Dashboard</button>
			<button id="user_infor" onclick="user_info()" style="width: 15%; height: 50px; background-color: #1A5276; font-size: 20px; color: rgb(255,255,255); border-style: none;">User Information</button>
			<button id="withdraw" onclick="withdraw()" style="width: 15%; height: 50px; background-color: #1A5276; font-size: 20px; color: rgb(255,255,255); border-style: none;">Withdraw</button>
			<button id="transfer" onclick="transfer()" style="width: 15%; height: 50px; background-color: #1A5276; font-size: 20px; color: rgb(255,255,255); border-style: none;">transfer</button>
			<button id="internal_transfer" onclick="internal_transfer()" style="width: 15%; height: 50px; background-color: #1A5276; font-size: 20px; color: rgb(255,255,255); border-style: none;">internal_transfer</button>
			<button id="transfer" onclick="history()" style="width: 15%; height: 50px; background-color: #1A5276; font-size: 20px; color: rgb(255,255,255); border-style: none;">history</button>
		</div>
		<div class="login" style="text-align: center; font-size: 20px; width: 100%; margin-top: 24px;">
			
			<label>Input ID of recieve account:</label><br/>
			<input type="number" id="input_id" name="" style="width: 50%; height: 50px; margin-top: 24px; margin-bottom: 24px;font-size: 24px;">
			<br/>
			<label>Input the number of tranfer money:</label><br/>
			<input type="number" id="input_money" name="" style="width: 50%; height: 50px;margin-top: 24px; margin-bottom: 24px;font-size: 24px;"><br/>
			<label>Select receive bank:</label><br/>
			<select id="bank_list" style="width: 50%; height: 50px;margin-top: 24px;font-size: 24px;"></select>
			<br/>
			<button onclick="transfer_action()" style="width: 50%; height: 50px;margin-top: 24px; border-style: none; background-color: #1A5276; color: rgb(255,255,255); font-size: 24px;">Continue</button>

		</div>
	<script src="/assets/jquery-3.1.1.min.js"></script>

	<script type="text/javascript">
		$(function() {
			$.ajax({
		          url: 'http://localhost:3000/account/isLogined',
		          dataType: 'json',
		          timeout: 10000
		        }).done(function(data){
		          if (data.message == "fail"){
		              alert("You need to login first!");
		              window.location = `./`;
		          }
		        });

			$.ajax({
				url: 'http://localhost:3000/account/banks',
				dataType: 'json',
          		timeout: 10000
			}).done(function(data){
				// console.log(data);
				$.each(data, function(idx, c) {
					var tr = '<option>'+c.bank_name+'</option>';							
					
					$('#bank_list').append(tr);
				});
				
			});
		});
	</script>



	<script type="text/javascript">
		function transfer_action() {
			var input_money = document.getElementById("input_money").value;
			var input_id = document.getElementById("input_id").value;
			var index = document.getElementById("bank_list").selectedIndex;

			if(input_id == ""){
				alert("The ID of recieve account is not null!");
			}else if (input_money == ""){
				alert("The number of money is not null!");		
			}else{
				var r = confirm("Are you sure want to transfer money!");
          		if (r == true) {
					$.ajax({
		            url: `http://localhost:3000/account/transfer?receiverAccId=${input_id}&amount=${input_money}&sameBank=${index}`,
		            dataType: 'json',
		            type:'POST',
		            timeout: 10000
		          }).done(function(data){
		            
		              alert(data.message);   
		              document.getElementById("input_money").value = ""; 
		              document.getElementById("input_id").value = "";          
		            
		          }).fail(function(jqXHR, textStatus, error){
		            alert("Task fail!");
		            console.log(textStatus);
		            console.log(error);
		            console.log(jqXHR);
		          });   
		      }
			}
			 
		}
	</script>

	<script type="text/javascript">
		function withdraw(){
			window.location = `./withdraw`;
		}
	</script>

	<script type="text/javascript">
			function dashboard(){
				window.location = `./dashboard`;
			}
		</script>

	<script type="text/javascript">
		function history(){
			window.location = `./history`;
		}
	</script>

	<script type="text/javascript">
		function user_info(){
			window.location = `./user_info`;
		}
	</script>

<script type="text/javascript">
		function internal_transfer(){
			window.location = `./internal_transfer`;
		}
	</script>

	<script type="text/javascript">
		function transfer(){
			window.location = `./transfer`;
		}
	</script>

</body>
</html>